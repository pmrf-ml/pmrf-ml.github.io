<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Posterior-Mean Rectified Flow: Towards Minimum MSE Photo-Realistic Image Restoration">
  <meta name="keywords" content="pmrf, rectified-flow, posterior-mean, image-restoration, super-resolution, flow-matching">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Posterior-Mean Rectified Flow: Towards Minimum MSE Photo-Realistic Image Restoration</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!--<script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>-->
  <!--
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>
  -->

  <!--<link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"-->
        <!--rel="stylesheet">-->

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

</head>
<body>

<!--
<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  -->
  <!--<div class="navbar-menu">-->
    <!--<div class="navbar-start" style="flex-grow: 1; justify-content: center;">-->
      <!--
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
      -->

      <!--
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            The Perception-Robustness Tradeoff in Deterministic Image Restoration (ICML 2024)
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
      -->
    <!--</div>-->

  <!--</div>-->
<!--</nav>-->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <div class="column has-text-centered" style="line-height: 0.1em;">
          <h1 class="title is-1 publication-title" style="margin-bottom: 0; font-family: 'Optima'; color: #414a4c;">
    Posterior-Mean Rectified Flow:
</h1>
            <h2 class="title is-3 publication-title" style="font-family: 'Optima'; color: #414a4c;">Towards Minimum MSE Photo-Realistic Image Restoration</h2>
          </div> 
          
          <div class="is-size-4 publication-authors">
            <span class="author-block">
              <a href="https://ohayonguy.github.io">Guy Ohayon</a>,</span>
            <span class="author-block">
              <a href="https://tomer.net.technion.ac.il/">Tomer Michaeli</a>,</span>
            <span class="author-block">
              <a href="https://elad.cs.technion.ac.il/">Michael Elad</a></span>

          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">Technionâ€”Israel Institute of Technology</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="static/PMRF.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>PDF</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2410.00418"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!--
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/ohayonguy/PMRF"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- c Link. -->
              <span class="link-block">
                <a href="https://drive.google.com/drive/folders/1dfjZATcQ451uhvFH42tKnfMNHRkL6N_A?usp=sharing"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-google-drive"></i>
                  </span>
                  <span>Checkpoints</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div style="display: flex; justify-content: center;">
    <div class="column is-five-fifths">

    <div class="hero-body">

      <h2 class="subtitle has-text-centered" style="font-size: 20px;">
        PMRF is a novel photo-realistic image restoration algorithm. It (provably) approximates the optimal estimator that minimizes the Mean Squared Error (MSE) under a perfect perceptual quality constraint.
      </h2>
            
      <div class="container is-max-desktop">
<div class="columns is-centered has-text-centered">
   <div class="comparison-block">
     <br>
         <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">

          <h2 class="title is-3">Example: Blind face image restoration</h2>
      </div>

<!--<h4>Example: Blind face image restoration</h4>-->
<img-comparison-slider>
  <img slot="first" src="static/images/blind/y/00000137.png" width="512"/>
  <img slot="second" src="static/images/blind/pmrf/00000137.png" width="512"/>
</img-comparison-slider>
  </div>
    </div>
    </div>
    <br><br>
      <h2 class="subtitle has-text-centered" style="font-size: 20px;">
      Given a degraded image (e.g., noisy, blurry), PMRF first predicts the posterior mean (the reconstruction that attains the smallest possible MSE), and then transports the result to a high-quality image using a rectified flow model.
      </h2>
      <img src="static/flow.png" alt="Centered Image" style="max-width: 100%;">
      
      </div>
      </div>
    </div>
  </div>
        </div>

</section>


<!--
<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>
-->


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-five-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p style="font-size: 20px;">
            Photo-realistic image restoration algorithms are typically evaluated by distortion measures (e.g., PSNR, SSIM) and by perceptual quality measures (e.g., FID, NIQE), where the desire is to attain the lowest possible distortion without compromising on perceptual quality. To achieve this goal, current methods typically attempt to sample from the posterior distribution, or to optimize a weighted sum of a distortion loss (e.g., MSE) and a perceptual quality loss (e.g., GAN). Unlike previous works, this paper is concerned specifically with the optimal estimator that minimizes the MSE under a constraint of perfect perceptual index, namely where the distribution of the reconstructed images is equal to that of the ground-truth ones. A recent theoretical result shows that such an estimator can be constructed by optimally transporting the posterior mean prediction (MMSE estimate) to the distribution of the ground-truth images. Inspired by this result, we introduce Posterior-Mean Rectified Flow (PMRF), a simple yet highly effective algorithm that approximates this optimal estimator. In particular, PMRF first predicts the posterior mean, and then transports the result to a high-quality image using a rectified flow model that approximates the desired optimal transport map. We investigate the theoretical utility of PMRF and demonstrate that it consistently outperforms previous methods on a variety of image restoration tasks.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!--
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div>
    -->
    <!--/ Paper video. -->
  </div>
</section>


  

<section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">

          <h2 class="title is-3">Additional examples</h2>
      </div><br>

<div class="container is-max-desktop">
<div class="columns is-centered has-text-centered">
 <div class="comparison-block">
<h4>Colorization</h4>
<img-comparison-slider>
  <img slot="first" src="static/images/colorization/y/00000065.png" width="230"/>
  <img slot="second" src="static/images/colorization/pmrf/00000065.png" width="230"/>
</img-comparison-slider>
 </div>
 <div class="comparison-block">
   <h4>Inpainting</h4>

<img-comparison-slider>
  <img slot="first" src="static/images/inpainting/y/00000656.png" width="230"/>
  <img slot="second" src="static/images/inpainting/pmrf/00000656.png" width="230"/>
   </img-comparison-slider>
  </div>
 <div class="comparison-block">
<h4>Denoising</h4>

<img-comparison-slider>
  <img slot="first" src="static/images/denoising/y/00000250.png" width="230"/>
  <img slot="second" src="static/images/denoising/pmrf/00000250.png" width="230"/>
   </img-comparison-slider></div>
 <div class="comparison-block">
<h4>Super-resolution</h4>
<img-comparison-slider>
  <img slot="first" src="static/images/sr/y/00000508.png" width="230"/>
  <img slot="second" src="static/images/sr/pmrf/00000508.png" width="230"/>
</img-comparison-slider>
  </div>
  </div>
      </div></div>
</section>


<script
  defer
  src="https://unpkg.com/img-comparison-slider@7/dist/index.js"
></script>



  

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title is-3">BibTeX</h2>
    <pre><code>@article{ohayon2024pmrf,
  author    = {Guy Ohayon and Tomer Michaeli and Michael Elad},
  title     = {Posterior-Mean Rectified Flow: Towards Minimum MSE Photo-Realistic Image Restoration},
  journal   = {arXiv preprint arXiv:2410.00418},
  year      = {2024},
  url       = {https://arxiv.org/abs/2410.00418}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is based on <a
              href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>. We thank the authors for their useful website template.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
